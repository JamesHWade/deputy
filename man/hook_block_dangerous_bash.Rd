% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hooks.R
\name{hook_block_dangerous_bash}
\alias{hook_block_dangerous_bash}
\title{Create a hook that blocks dangerous bash commands}
\usage{
hook_block_dangerous_bash(patterns = NULL, additional_patterns = NULL)
}
\arguments{
\item{patterns}{Character vector of regex patterns to block.
Default includes comprehensive dangerous patterns.}

\item{additional_patterns}{Optional character vector of additional
patterns to block alongside defaults.}
}
\value{
A \link{HookMatcher} object
}
\description{
Convenience function to create a PreToolUse hook that blocks potentially
dangerous bash commands. Default patterns include:

\strong{File system destruction:}
\code{rm -rf}, \code{mkfs}, \verb{dd if=}, writes to \verb{/dev/}

\strong{Privilege escalation:}
\code{sudo}, \verb{su -}, \verb{chmod 777}, \code{chown}, \code{setuid}

\strong{Code execution:}
\code{eval}, \code{exec}, \code{source} (with variables), backticks

\strong{Process manipulation:}
\code{kill -9}, \code{killall}, \code{pkill}, fork bombs

\strong{System modification:}
\code{crontab}, \code{systemctl}, \verb{/etc/passwd}, \verb{/etc/shadow}

\strong{Network exfiltration:}
\verb{curl -X POST}, \code{wget --post}, \code{nc -e}, \code{netcat}, reverse shells

\strong{Obfuscation detection:}
Variable expansion in commands, base64 piping, hex/octal escapes,
quote splitting, backslash escapes

\strong{Security Note:} This is defense-in-depth and cannot catch all possible
obfuscation techniques. For high-security environments, consider:
\enumerate{
\item Using sandboxed execution (Docker, firejail)
\item Disabling bash entirely via \link{Permissions}
\item Using a command whitelist instead of blacklist
}
}
\examples{
\dontrun{
# Use default patterns
agent$add_hook(hook_block_dangerous_bash())

# Add custom patterns
agent$add_hook(hook_block_dangerous_bash(
  additional_patterns = c("my_custom_pattern", "another_pattern")
))
}

}
